!function(e){"use strict"}(window.$dhx=window.$dhx||{}),function(e){"use strict"}($dhx.ui=$dhx.ui||{}),function(e){"use strict";var t,i,r,n,o=[],s=[],d=[],p={},h=function(r){"undefined"==typeof r.appId&&(r.appId=""+Math.random()),this.appId=r.appId,this.container=r.container,this.root=r.root,this.icons_path=r.icons_path,t=r.root,p=r,p.from="super";var n=e.triggerMethod("before:start",p);if(!n)throw" application will not initialize due a onBeforeStart event returning false";this.initialize(p),i=this},u=function(e){window.addEventListener("popstate",function(e){document.location.hash.replace(/#/gi,"").toString().length>2&&r.presenter._view.dispatch(document.location.hash.replace(/#/gi,""))}),r=this},c=function(t){c=e.copyTo(c,t),this.appId=i.appId,this.container=i.container,this.root=i.root,this.icons_path=i.icons_path,this.dispatch=function(e){try{n._wrapper.cells(e.split("?")[0]).setActive(),window.dhx4.callEvent("onSidebarSelect",[e.split("?")[0],n._wrapper.cells(e.split("?")[0])])}catch(t){console.log(t.stack)}n._router.dispatch(e,!0)},n=this},a=function(t){a=e.copyTo(a,t),this.appId=i.appId,this.container=i.container,this.root=i.root,this.icons_path=i.icons_path,this.dispatch=function(e){try{n._wrapper.cells(e.split("?")[0]).setActive(),window.dhx4.callEvent("onSidebarSelect",[e.split("?")[0],n._wrapper.cells(e.split("?")[0])])}catch(t){console.log(t.stack)}n._router.dispatch(e,!0)}},l=!1,m=!1,b=function(e){return e.topic=i.appId+".presenter",e._view.topic=i.appId+".view",e._model.topic=i.appId+".model",e._subscriber=e._subscriber||function(t,i){t==e._view.topic||t==e._model.topic},e._subscriber_view_token=$dhx.MQ.subscribe(e._view.topic,e._subscriber),e._subscriber_model_token=$dhx.MQ.subscribe(e._model.topic,e._subscriber),e._view._subscriber=e._view._subscriber||function(e,t){},e._view._subscriber_presenter_token=$dhx.MQ.subscribe(e.topic,e._view._subscriber),e._model._subscriber=e._model._subscriber||function(e,t){},e._model._subscriber_presenter_token=$dhx.MQ.subscribe(e.topic,e._model._subscriber),e};h.prototype={initialize:function(e){},start:function(t){var n=(window.location.hash,[]),o=[i.root+"lib/view/"+("test"!=$dhx.environment?"min.":"")+"view.js",i.root+"lib/model/"+("test"!=$dhx.environment?"min.":"")+"model.js",i.root+"lib/presenter/"+("test"!=$dhx.environment?"min.":"")+"presenter.js"];t=t||{},n.push(i.root+"lib/thirdparty/codebase5.0_std/dhtmlx.css"),n.push(i.root+"lib/thirdparty/codebase5.0_std/dhtmlx.js"),n.push(i.root+"lib/dhx/min.dhx.MQ.js"),t.full?(n.push(i.root+"lib/thirdparty/jquery.min.js"),n.push("https://cdn.jsdelivr.net/pouchdb/5.4.5/pouchdb.min.js"),n.push(i.root+"lib/dhx/min.dhx.ui.i18n.js"),n.push(i.root+"lib/dhx/min.dhx.ui.i18n.en-us.js"),n.push(i.root+"lib/thirdparty/moment.min.js"),n.push(i.root+"lib/thirdparty/moment-timezone-with-data.min.js"),n.push(i.root+"lib/dhx/min.dhtmlx_grid_moment_type.js"),n.push(i.root+"lib/dhx/min.dhx.excells.js"),n.push(i.root+"lib/dhx/min.dhx.crypt.js"),n.push(i.root+"lib/dhx/min.dhx.component.js"),n.push(i.root+"lib/dhx/min.dhx.dhtmlx.js"),n.push(i.root+"lib/dhx/min.dhx.ui.form.js")):(t.stripe&&n.push("https://js.stripe.com/v2/"),t.pouch&&n.push("https://cdn.jsdelivr.net/pouchdb/5.4.5/pouchdb.min.js"),t.backboneIDB&&(n.push(i.root+"lib/thirdparty/min.underscore.js"),n.push(i.root+"lib/thirdparty/backbone-min.js"),n.push(i.root+"lib/thirdparty/min.backbone-indexeddb.js")),t.$dhx_crypt&&n.push(i.root+"lib/dhx/min.dhx.crypt.js"),(t.$dhx_grid||t.$dhx_form)&&(n.push(i.root+"lib/thirdparty/jquery.min.js"),n.push(i.root+"lib/dhx/min.dhx.ui.i18n.js"),n.push(i.root+"lib/dhx/min.dhx.ui.i18n.en-us.js"),n.push(i.root+"lib/thirdparty/moment.min.js"),n.push(i.root+"lib/thirdparty/moment-timezone-with-data.min.js"),n.push(i.root+"lib/dhx/min.dhtmlx_grid_moment_type.js"),n.push(i.root+"lib/dhx/min.dhx.component.js"),n.push(i.root+"lib/thirdparty/creditcard.min.js")),t.$dhx_grid&&n.push(i.root+"lib/dhx/min.dhx.excells.js"),t.$dhx_form&&(n.push(i.root+"lib/dhx/min.dhx.dhtmlx.js"),n.push(i.root+"lib/dhx/min.dhx.ui.form.js"))),$dhx.onDemand.require(n,function(){$dhx.onDemand.require(o,function(){var t=$dhx.ui.mvp.presenters.get("presenter"),n=$dhx.ui.mvp.views.get("view"),o=$dhx.ui.mvp.models.get("model");n.model=o,n.rendered=!1,n.initialize(),t._view=n,t.view=n,t._model=o,t.model=o,t=b(t),i.presenters=$dhx.ui.mvp.presenters,i.views=$dhx.ui.mvp.views,r.presenter=t,n._router=r,n.presenter=t,i.main_presenter=t,i.main_view=n,e.first_dispatched||e.first_dispatch()})})}},u.prototype={dispatch:function(t,d){var p=this,h="start",u=t.split("?")[0];if(!(u in this.routes))throw"Undeclared "+u+" route";if(this.routes[u].method&&(h=this.routes[u].method),l&&"#"!=l){m=l;try{s[m].destroy(),o[m].destroy(),$dhx.MQ.unsubscribe(o[m]._subscriber_presenter_token),$dhx.MQ.unsubscribe(s[m]._subscriber_model_token),$dhx.MQ.unsubscribe(s[m]._subscriber_view_token)}catch(c){}o[m]=null,s[m]=null,delete o[m],delete s[m]}if(l=u,d===!0){var a={url:l},_=(window.location.hash,l),x="?";"true"==e.queryString("_enable_log",t)&&(x+="_enable_log=true"),null!==e.queryString("item",t)&&""!==e.queryString("item",t)&&(x+="?"==x?"item="+e.queryString("item",t):"&item="+e.queryString("item",t)),"?"==x&&(x=""),history.pushState(a,_,"#"==l?l+x:"#"+l+x)}if("#"!=l&&(this.routes[l].presenter=this.routes[l].presenter||u.replace(/\//g,""),this.routes[l].view=this.routes[l].view||u.replace(/\//g,"")),this.routes[l].presenter){var v=[];this.routes[l].view&&v.push(i.root+"lib/view/"+("test"!=$dhx.environment?"min.":"")+this.routes[l].view+".js"),v.push(i.root+"lib/presenter/"+("test"!=$dhx.environment?"min.":"")+this.routes[l].presenter+".js"),this.routes[l].append_views&&this.routes[l].append_views.forEach(function(e){v.push(i.root+"lib/view/"+("test"!=$dhx.environment?"min.":"")+e[Object.keys(e)[0]]+".js")}),$dhx.onDemand.load(v,function(){s[l]=$dhx.ui.mvp.presenters.get(p.routes[l].presenter),o[l]=$dhx.ui.mvp.views.get(p.routes[l].view),p.routes[l].append_views&&p.routes[l].append_views.forEach(function(e){o[l][Object.keys(e)[0]]=window[e[Object.keys(e)[0]]]}),s[l]._view=o[l],s[l]._view._wrapper=n._wrapper,s[l]._view.app={mainView:$dhx.ui.mvp.views.get("view"),_child_presenters:s,_child_views:o},s[l]._view.window_manager=n.window_manager,s[l].model=r.presenter._model,s[l].view=o[l],s[l]._model||(s[l]._model=r.presenter._model),s[l]=b(s[l]),o[l].model=r.presenter._model,o[l].presenter=s[l],s[l].start(),o[l].initialize(),o[l].render(r.presenter._model,s[l]),$dhx.MQ.publish(s[l].topic,{action:"start",target:null})})}else this.presenter[h]?this.presenter[h]():r[h]&&r[h]();i.active_route=l},route:function(e){this.routes[e.url]=e}},c.prototype={initialize:function(e){}},a.prototype={initialize:function(e){}},e.router={extend:function(t){var i=function(){};return e.extend({base:u,factory:t,onBeforeExtend:function(e){e=e||{},e.presenter=e.presenter||{start:i},e.presenter.start=e.presenter.start||i,e.routes=e.routes||{},e.routes.hasOwnProperty("#")||(e.routes["#"]={url:"#",method:"start"})}})}},e.application={extend:function(t){return e.extend({base:h,factory:t,onBeforeExtend:function(){}})}},e.main_view={extend:function(t){return e.extend({base:c,factory:t,onBeforeExtend:function(){}})}},e.child_view={extend:function(t){return e.extend({base:a,factory:t,onBeforeExtend:function(){}})}},e.queryString=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=i.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},e.first_dispatched=!1,e.first_dispatch=function(){var t=window.location.hash||"";t&&(t=t.toString().replace(/#/,"")),r.dispatch("#",!0),e.triggerMethod("start",p),$dhx.ui.i18n&&$dhx.ui.i18n.start(),$dhx.excells&&$dhx.excells.init(),t.indexOf("/")!=-1?r.presenter._view.render({onSuccess:function(){e.triggerMethod("render",p),$dhx.ui.mvp.views.get("view").rendered=!0,$dhx.ui.mvp.views.get("view").dispatch(t)},ok:function(){e.triggerMethod("render",p),$dhx.ui.mvp.views.get("view").rendered=!0,$dhx.ui.mvp.views.get("view").dispatch(t)},onFail:function(){}}):r.presenter._view.render({onSuccess:function(){e.triggerMethod("render",p),$dhx.ui.mvp.views.get("view").rendered=!0},ok:function(){e.triggerMethod("render",p),$dhx.ui.mvp.views.get("view").rendered=!0},onFail:function(){}}),$dhx.MQ.publish(r.presenter.topic,{action:"start",target:null}),e.first_dispatched=!0},e.extend=function(t){var i=t.base,r=t.factory,n=null;return t.onBeforeExtend&&t.onBeforeExtend(r),n=function(e){e=e||{},i.call(this,e)},n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n=e.copyTo(n,r),n.on=function(e,t){d.push({pattern:e,fn:t,base:i})},n.start=function(e){p=e},n},e.copyTo=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e.prototype[i]=t[i]);return e},e.triggerMethod=function(){var e=arguments[0],t=arguments[1]||!1,i=[];return d.forEach(function(r){r.pattern===e&&(t?i.push(r.fn(t)):i.push(r.fn()))}),!(i.join(".").indexOf("false")>-1)},e.views={views:[],declare:function(t){var i=Object.keys(t)[0];i=i.toString().replace(/\//g,""),e.views.views[i]=t[i]},get:function(t){return t=t.toString().replace(/\//g,""),e.views.views[t]||!1}},e.presenters={presenters:[],declare:function(t){var i=Object.keys(t)[0];i=i.toString().replace(/\//g,""),e.presenters.presenters[i]=t[i]},get:function(t){return t=t.toString().replace(/\//g,""),e.presenters.presenters[t]||!1}},e.models={models:[],declare:function(t){var i=Object.keys(t)[0];i=i.toString().replace(/\//g,""),e.models.models[i]=t[i]},get:function(t){return t=t.toString().replace(/\//g,""),e.models.models[t]||!1}}}($dhx.ui.mvp=$dhx.ui.mvp||{});