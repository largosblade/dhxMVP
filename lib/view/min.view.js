$dhx.ui.mvp.views.declare({view:function(){"strict";var t=$dhx.ui.mvp.main_view.extend({}),e=new t({_settings:{sidebar_buttons:[],sidebar:{template:$dhx.ui.mvp.ui.isMobile?"detail":"tiles",icons_path:null,width:200,header:!!$dhx.ui.mvp.ui.isMobile,autohide:!!$dhx.ui.mvp.ui.isMobile,items:[{id:"#",text:"Dashboard",icon:"dashboard.png",selected:!0}]},toolbar:{icons_size:$dhx.ui.mvp.ui.isMobile?16:32,icons_path:"",items:[{type:"button",id:"logo",img_disabled:"",text:"<span style='font-size: 14px;'>dhx</span><span style='font-weight: bold; font-size: 14px;'>MV*</span>",disabled:!0},{type:"separator"},{type:"text",id:"title",text:"<img src='"+app.root+"assets/icons/64/dashboard.png' width='32' style='position:relative;float:left; margin-top:10px; margin-right: 10px;' /><span style='font-weight: bold; font-size: 14px;'>Dashboard</span>"},{type:$dhx.ui.mvp.ui.isMobile?"separator":"spacer"},{type:"separator"},{type:"button",id:"/logout",img:"logout.png",img_disabled:"logout.png"}]},layout:{pattern:"4C",cells:[{id:"a",text:"Overall information"},{id:"b",text:"Database Collections - IndexedDB"},{id:"c",text:"Collections data - IndexedDB"},{id:"d",text:"Collections size - IndexedDB"}]},form:{template:[{type:"settings",position:$dhx.ui.mvp.ui.isMobile?"label-top":"label-left",labelWidth:$dhx.ui.mvp.ui.isMobile?250:160,offsetLeft:10}]},chart_database_collections:{view:"bar",value:"#items#",color:"#color#",label:"#collection#",tooltip:"#collection# collection",gradient:"rising",radius:0,barWidth:35},chart_collections_data:{view:"barH",value:"#items#",color:"#color#",tooltip:"#collection# #items#",barWidth:35,radius:0,gradient:"rising",xAxis:{title:"Documents per collection",start:0,step:50}},chart_collections_size:{view:"barH",value:"#size#",color:"#color#",tooltip:"#collection# #size# kB",barWidth:35,radius:0,gradient:"rising",xAxis:{title:"Collections per size in kB",start:0,step:50}}},status_bar:null,sidebar:null,toolbar:null,layout:null,form:null,chart_database_collections:null,chart_collections_data:null,chart_collections_size:null,initialize:function(t){},_sidebar:function(){var t=this;return null===t.sidebar&&(t._settings.sidebar.parent=t.container,t._settings.sidebar.icons_path=t.icons_path,t.sidebar=new dhtmlXSideBar(t._settings.sidebar),t.sidebar.attachEvent("onSelect",t.presenter.sidebarOnSelectHandler),t._wrapper=t.sidebar),t.sidebar},_toolbar:function(){var t=this;return null===t.toolbar&&(t._settings.toolbar.icons_path=t.icons_path,t.toolbar=t.sidebar.attachToolbar(t._settings.toolbar),t.toolbar.attachEvent("onClick",t.presenter.toolbarOnClickHandler)),t.toolbar},_layout:function(){var t=this;return null===t.layout&&(t.layout=t.sidebar.cells("#").attachLayout(t._settings.layout),t.layout.attachEvent("onExpand",t.presenter.layoutOnExpandHandler),t.layout.setAutoSize("a","b;c;d"),t.layout.cells("a").setWidth(400)),t.layout},_form:function(){var t=this;return null!==this.form&&(t.form.unload(),t.form=null),t._settings.form.template.push({type:"template",name:"system_type",label:"System type",value:$dhx.Browser.OS+" "+(navigator.oscpu?navigator.oscpu:""),format:simple_text}),t._settings.form.template.push({type:"template",name:"browser",label:"Browser",value:$dhx.Browser.name+" "+$dhx.Browser.version,format:simple_text}),t._settings.form.template.push({type:"template",name:"online",label:"Online",value:$dhx.Browser.onLine,format:simple_text}),t._settings.form.template.push({type:"template",name:"notification_permission",label:"Notification Permission",value:'<div><input type="button" id="dhx_npermission" value="'+Notification.permission+'" onclick="$dhx.ui.mvp.presenters.get(\'presenter\').askNotificationPermission()" /></div>',format:simple_text}),t._settings.form.template.push({type:"template",name:"location_permission",label:"Location Permission",value:'<div><input type="button" id="location_npermission" value="checking ..." onclick="$dhx.ui.mvp.presenters.get(\'presenter\').askLocationPermission()" /></div>',format:simple_text}),t._settings.form.template.push({type:"template",name:"current_location",label:"Current Location",value:'<div id="current_location"></div>',format:simple_text}),t._settings.form.template.push({type:"template",name:"quota",label:"Local database Quota (IndexedDB)",value:'<div id="dhx_quota"><span style="color:red">This browser does not provide quota management.</span></div>',format:simple_text}),$dhx.ui.mvp.ui.getQuota(function(t,e){document.getElementById("dhx_quota").innerHTML="Used: "+t+"GB. <br>Remaining: "+e+"GB"}),t.form=t.layout.cells("a").attachForm(t._settings.form.template),navigator.geolocation.getCurrentPosition(function(t){console.log("DDDDD: ",t.coords),document.getElementById("current_location").innerHTML="Latitude: "+t.coords.latitude+". <br>Longitude: "+t.coords.longitude,document.getElementById("location_npermission").value="granted"},function(t){document.getElementById("location_npermission").value="require permission"}),t.form.attachEvent("onButtonClick",function(t){}),t.form},_chart_database_collections:function(){var t=this;return null===t.chart_database_collections&&(t.chart_database_collections=t.layout.cells("b").attachChart(t._settings.chart_database_collections)),t.chart_database_collections},_chart_collections_data:function(){var t=this;return null===t.chart_collections_data&&(t.chart_collections_data=t.layout.cells("c").attachChart(t._settings.chart_collections_data),t.chart_collections_data.define("legend",{width:150,align:"right",valign:"top",marker:{type:"round",width:15},toggle:!0,template:"#collection# #items#"})),t.chart_collections_data},_chart_collections_size:function(){var t=this;return null===t.chart_collections_size&&(t.chart_collections_size=t.layout.cells("d").attachChart(t._settings.chart_collections_size),t.chart_collections_size.define("legend",{width:150,align:"right",valign:"top",marker:{type:"round",width:15},toggle:!0,template:"#collection# #size# kB"})),t.chart_collections_size},onDispatch:function(t){var e=this;try{e.sidebar.cells(t.split("?")[0]).setActive(),window.dhx4.callEvent("onSidebarSelect",[t.split("?")[0],e.sidebar.cells(t.split("?")[0])]),$dhx.ui.mvp.ui.isMobile||e.toolbar.setItemText("title",window.dhx4.template("<img src='"+e.root+"assets/icons/64/#image#' width='32' style='position:relative;float:left; margin-top:10px; margin-right: 10px;' /><span style='font-weight: bold; font-size: 14px;'>#text#</span>",{text:e.sidebar.cells(t).getText().text,image:e.sidebar.cells(t).getText().text.toLowerCase()+".png"}))}catch(i){}},render:function(t){var e=this;e._sidebar(),e.presenter.start_database({onSuccess:function(){$dhx.ui.mvp.ui.isMobile&&e.layout.cells("a").collapse(),$dhx.ui.mvp.ui.isMobile&&e.layout.cells("b").collapse(),t.ok({onComplete:function(t){t=t.split("/")[0],$dhx.ui.mvp.ui.isMobile||e.toolbar.setItemText("title",window.dhx4.template("<img src='"+e.root+"assets/icons/64/#image#' width='32' style='position:relative;float:left; margin-top:10px; margin-right: 10px;' /><span style='font-weight: bold; font-size: 14px;'>#text#</span>",{text:e.sidebar.cells(t).getText().text,image:e.sidebar.cells(t).getText().text.toLowerCase()+".png"})),e.sidebar.cells(t).setActive()}})}})}});return e}()});